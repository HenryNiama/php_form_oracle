const btnBuscar=document.getElementById("btnBuscar");let CE_RUCIC=document.getElementById("CE_RUCIC_CEDULA_PASSPORT");const form=document.getElementById("formulario"),guardarBtn=document.getElementById("guardarBtn"),formularioActualizado=document.getElementById("formularioActualizado");function buscarCedulaRUC(){btnBuscar.addEventListener("click",(function(e){if(e.preventDefault(),validarCedulaRUC()){new bootstrap.Modal(document.getElementById("myModal")).show(),consultarClienteAPI()}}))}function validarCedulaRUC(){const e=CE_RUCIC.value;if(!e)return Swal.fire("Error","El RUC o Cédula es obligatorio.","error"),!1;const t=e.length;return 10===t||13===t||(Swal.fire("Error","El RUC o Cédula debe tener 10 o 13 dígitos.","error"),!1)}async function consultarClienteAPI(){var e=CE_RUCIC.value;try{const t="/api/get-client-data?CE_RUCIC="+e,n=await fetch(t);imprimirDatos(await n.json())}catch(e){console.log(e)}}function imprimirDatos(e){const{CE_NOMBRE:t,CE_APELLI:n,CE_RAZONS:E,CE_RUCIC:o,CE_NOMREP:a,CE_APEREP:l,CE_CADOM1:m,CE_CADOM2:d,CE_SECDOM:u,CE_CAOFI1:C,CE_CAOF2:r,CE_SECOFI:c,CE_CAENT1:i,CE_CAENT2:I,CE_SECENT:_,CE_TELDOM:g,CE_TELOFI:B,CE_TELBOD:s,CE_FAX:v,CE_EMAIL:y}=e;document.getElementById("CE_NOMBRE").value=t,document.getElementById("CE_APELLI").value=n,document.getElementById("CE_RAZONS").value=E,document.getElementById("CE_RUCIC").value=o,document.getElementById("CE_NOMREP").value=a,document.getElementById("CE_APEREP").value=l,document.getElementById("CE_CADOM1").value=m,document.getElementById("CE_CADOM2").value=d,document.getElementById("CE_SECDOM").value=u,document.getElementById("CE_CAOFI1").value=C,document.getElementById("CE_CAOF2").value=r,document.getElementById("CE_SECOFI").value=c,document.getElementById("CE_CAENT1").value=i,document.getElementById("CE_CAENT2").value=I,document.getElementById("CE_SECENT").value=_,document.getElementById("CE_TELDOM").value=g,document.getElementById("CE_TELOFI").value=B,document.getElementById("CE_TELBOD").value=s,document.getElementById("CE_FAX").value=v,document.getElementById("CE_EMAIL").value=y}function guardarInformacion(){guardarBtn.addEventListener("click",()=>{validarDatosLlenados()?enviarDatosAPI():Swal.fire("Error","Por favor, completa todos los campos y acepta los términos y condiciones","error")})}function validarDatosLlenados(){const e=document.getElementById("CE_NOMBRE").value,t=document.getElementById("CE_APELLI").value,n=document.getElementById("CE_RAZONS").value,E=document.getElementById("CE_RUCIC").value,o=document.getElementById("CE_NOMREP").value,a=document.getElementById("CE_APEREP").value,l=document.getElementById("CE_CADOM1").value,m=document.getElementById("CE_CADOM2").value,d=document.getElementById("CE_SECDOM").value,u=document.getElementById("CE_CAOFI1").value,C=document.getElementById("CE_CAOF2").value,r=document.getElementById("CE_SECOFI").value,c=document.getElementById("CE_CAENT1").value,i=document.getElementById("CE_CAENT2").value,I=document.getElementById("CE_SECENT").value,_=document.getElementById("CE_TELDOM").value,g=document.getElementById("CE_TELOFI").value,B=document.getElementById("CE_TELBOD").value,s=document.getElementById("CE_FAX").value,v=document.getElementById("CE_EMAIL").value,y=document.getElementById("terminos").checked;return!(""===e.trim()||""===t.trim()||""===n.trim()||""===E.trim()||""===o.trim()||""===a.trim()||""===l.trim()||""===m.trim()||""===d.trim()||""===u.trim()||""===C.trim()||""===r.trim()||""===c.trim()||""===i.trim()||""===I.trim()||""===_.trim()||""===g.trim()||""===B.trim()||""===s.trim()||""===v.trim()||!y)}async function enviarDatosAPI(){const e=new URLSearchParams(new FormData(formularioActualizado));fetch("/",{method:"POST",body:e}).then(e=>e.text()).then(e=>{console.log(e),Swal.fire({title:"Datos actualizados correctamente",text:"Se actualizaron los datos correctamente",icon:"success",didClose:()=>{window.location.href="/"}})}).catch(e=>{console.error(e)})}function submitFormulario(){formularioActualizado.addEventListener("submit",(function(e){e.preventDefault(),console.log("Enviando formulario...")}))}document.addEventListener("DOMContentLoaded",(function(){buscarCedulaRUC(),guardarInformacion(),submitFormulario()}));